/*
 *       /\        Matteo Cicuttin (C) 2016, 2017, 2018
 *      /__\       matteo.cicuttin@enpc.fr
 *     /_\/_\      École Nationale des Ponts et Chaussées - CERMICS
 *    /\    /\
 *   /__\  /__\    DISK++, a template library for DIscontinuous SKeletal
 *  /_\/_\/_\/_\   methods.
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * If you use this code or parts of it for scientific publications, you
 * are required to cite it as following:
 *
 * Implementation of Discontinuous Skeletal methods on arbitrary-dimensional,
 * polytopal meshes using generic programming.
 * M. Cicuttin, D. A. Di Pietro, A. Ern.
 * Journal of Computational and Applied Mathematics.
 * DOI: 10.1016/j.cam.2017.09.017
 */

#pragma once

namespace dunavant_quadratures {

static double rule_1[][4] = {
	{ 0.333333333333333, 0.333333333333333, 0.333333333333333,  1.000000000000000 }
};

static double rule_2[][4] = {
	{ 0.666666666666667, 0.166666666666667, 0.166666666666667,  0.333333333333333 },
	{ 0.166666666666667, 0.666666666666667, 0.166666666666667,  0.333333333333333 },
	{ 0.166666666666667, 0.166666666666667, 0.666666666666667,  0.333333333333333 }
};

static double rule_3[][4] = {
	{ 0.333333333333333, 0.333333333333333, 0.333333333333333, -0.562500000000000 },
    { 0.600000000000000, 0.200000000000000, 0.200000000000000,  0.520833333333333 },
    { 0.200000000000000, 0.600000000000000, 0.200000000000000,  0.520833333333333 },
    { 0.200000000000000, 0.200000000000000, 0.600000000000000,  0.520833333333333 }
};

static double rule_4[][4] = {
	{ 0.108103018168070, 0.445948490915965, 0.445948490915965,  0.223381589678011 },
	{ 0.445948490915965, 0.108103018168070, 0.445948490915965,  0.223381589678011 },
	{ 0.445948490915965, 0.445948490915965, 0.108103018168070,  0.223381589678011 },
    { 0.816847572980459, 0.091576213509771, 0.091576213509771,  0.109951743655322 },
    { 0.091576213509771, 0.816847572980459, 0.091576213509771,  0.109951743655322 },
    { 0.091576213509771, 0.091576213509771, 0.816847572980459,  0.109951743655322 }
};

static double rule_5[][4] = {
	{ 0.333333333333333, 0.333333333333333, 0.333333333333333,  0.225000000000000 },
    { 0.059715871789770, 0.470142064105115, 0.470142064105115,	0.132394152788506 },
    { 0.470142064105115, 0.059715871789770, 0.470142064105115,	0.132394152788506 },
    { 0.470142064105115, 0.470142064105115,	0.059715871789770,  0.132394152788506 },
    { 0.797426985353087, 0.101286507323456, 0.101286507323456,  0.125939180544827 },
    { 0.101286507323456, 0.797426985353087, 0.101286507323456,  0.125939180544827 },
    { 0.101286507323456, 0.101286507323456, 0.797426985353087,  0.125939180544827 },
};

static double rule_6[][4] = {
    { 0.501426509658179, 0.249286745170910, 0.249286745170910,  0.116786275726379 },
    { 0.249286745170910, 0.501426509658179, 0.249286745170910,  0.116786275726379 },
    { 0.249286745170910, 0.249286745170910, 0.501426509658179,  0.116786275726379 },
    { 0.873821971016996, 0.063089014491502, 0.063089014491502,  0.050844906370207 },
    { 0.063089014491502, 0.873821971016996, 0.063089014491502,  0.050844906370207 },
    { 0.063089014491502, 0.063089014491502, 0.873821971016996,  0.050844906370207 },
    { 0.053145049844817, 0.310352451033784, 0.636502499121399,  0.082851075618374 },
    { 0.053145049844817, 0.636502499121399, 0.310352451033784,  0.082851075618374 },
    { 0.310352451033784, 0.053145049844817, 0.636502499121399,  0.082851075618374 },
    { 0.310352451033784, 0.636502499121399, 0.053145049844817,  0.082851075618374 },
    { 0.636502499121399, 0.053145049844817, 0.310352451033784,  0.082851075618374 },
    { 0.636502499121399, 0.310352451033784, 0.053145049844817,  0.082851075618374 },
};

static double rule_7[][4] = {
    { 0.333333333333333, 0.333333333333333, 0.333333333333333, -0.149570044467682 },
    { 0.479308067841920, 0.260345966079040, 0.260345966079040,  0.175615257433208 },
    { 0.260345966079040, 0.479308067841920, 0.260345966079040,  0.175615257433208 },
    { 0.260345966079040, 0.260345966079040, 0.479308067841920,  0.175615257433208 },
    { 0.869739794195568, 0.065130102902216, 0.065130102902216,  0.053347235608838 },
    { 0.065130102902216, 0.869739794195568, 0.065130102902216,  0.053347235608838 },
    { 0.065130102902216, 0.065130102902216, 0.869739794195568,  0.053347235608838 },  
    { 0.048690315425316, 0.312865496004874, 0.638444188569810,  0.077113760890257 },
    { 0.048690315425316, 0.638444188569810, 0.312865496004874,  0.077113760890257 },
    { 0.312865496004874, 0.048690315425316, 0.638444188569810,  0.077113760890257 },
    { 0.312865496004874, 0.638444188569810, 0.048690315425316,  0.077113760890257 },
    { 0.638444188569810, 0.048690315425316, 0.312865496004874,  0.077113760890257 },
    { 0.638444188569810, 0.312865496004874, 0.048690315425316,  0.077113760890257 }
};

static double rule_8[][4] = {
	{ 0.333333333333333, 0.333333333333333, 0.333333333333333,  0.144315607677787 },
    { 0.081414823414554, 0.459292588292723, 0.459292588292723,  0.095091634267285 },
    { 0.459292588292723, 0.081414823414554, 0.459292588292723,  0.095091634267285 },
    { 0.459292588292723, 0.459292588292723, 0.081414823414554,  0.095091634267285 },
    { 0.658861384496480, 0.170569307751760, 0.170569307751760,  0.103217370534718 },
    { 0.170569307751760, 0.658861384496480, 0.170569307751760,  0.103217370534718 },
    { 0.170569307751760, 0.170569307751760, 0.658861384496480,  0.103217370534718 },
    { 0.898905543365938, 0.050547228317031, 0.050547228317031,  0.032458497623198 },
    { 0.050547228317031, 0.898905543365938, 0.050547228317031,  0.032458497623198 },
    { 0.050547228317031, 0.050547228317031, 0.898905543365938,  0.032458497623198 },
    { 0.008394777409958, 0.263112829634638, 0.728492392955404,  0.027230314174435 },
    { 0.008394777409958, 0.728492392955404, 0.263112829634638,  0.027230314174435 },
    { 0.263112829634638, 0.008394777409958, 0.728492392955404,  0.027230314174435 },
    { 0.263112829634638, 0.728492392955404, 0.008394777409958,  0.027230314174435 },
    { 0.728492392955404, 0.008394777409958, 0.263112829634638,  0.027230314174435 },
    { 0.728492392955404, 0.263112829634638, 0.008394777409958,  0.027230314174435 }
};

static double rule_9[][4] = {
    { 0.333333333333333, 0.333333333333333, 0.333333333333333, 0.097135796282799 }, //
    { 0.020634961602525, 0.489682519198738, 0.489682519198738, 0.031334700227139 }, //
    { 0.489682519198738, 0.020634961602525, 0.489682519198738, 0.031334700227139 },
    { 0.489682519198738, 0.489682519198738, 0.020634961602525, 0.031334700227139 },
    { 0.125820817014127, 0.437089591492937, 0.437089591492937, 0.077827541004774 }, //
    { 0.437089591492937, 0.125820817014127, 0.437089591492937, 0.077827541004774 },
    { 0.437089591492937, 0.437089591492937, 0.125820817014127, 0.077827541004774 },
    { 0.623592928761935, 0.188203535619033, 0.188203535619033, 0.079647738927210 }, //
    { 0.188203535619033, 0.623592928761935, 0.188203535619033, 0.079647738927210 },
    { 0.188203535619033, 0.188203535619033, 0.623592928761935, 0.079647738927210 },
    { 0.910540973211095, 0.044729513394453, 0.044729513394453, 0.025577675658698 }, //
    { 0.044729513394453, 0.910540973211095, 0.044729513394453, 0.025577675658698 },
    { 0.044729513394453, 0.044729513394453, 0.910540973211095, 0.025577675658698 },
    { 0.036838412054736, 0.221962989160766, 0.741198598784498, 0.043283539377289 }, //
    { 0.036838412054736, 0.741198598784498, 0.221962989160766, 0.043283539377289 },
    { 0.221962989160766, 0.036838412054736, 0.741198598784498, 0.043283539377289 },
    { 0.221962989160766, 0.741198598784498, 0.036838412054736, 0.043283539377289 },
    { 0.741198598784498, 0.036838412054736, 0.221962989160766, 0.043283539377289 },
    { 0.741198598784498, 0.221962989160766, 0.036838412054736, 0.043283539377289 }
};


struct rule {
	size_t num_points;
	double (*data)[4];
};

static struct rule rules[] = {
	{ sizeof(rule_1)/(sizeof(double)*4), rule_1 },
	{ sizeof(rule_2)/(sizeof(double)*4), rule_2 },
	{ sizeof(rule_3)/(sizeof(double)*4), rule_3 },
	{ sizeof(rule_4)/(sizeof(double)*4), rule_4 },
	{ sizeof(rule_5)/(sizeof(double)*4), rule_5 },
	{ sizeof(rule_6)/(sizeof(double)*4), rule_6 },
	{ sizeof(rule_7)/(sizeof(double)*4), rule_7 },
	{ sizeof(rule_8)/(sizeof(double)*4), rule_8 },
	{ sizeof(rule_9)/(sizeof(double)*4), rule_9 }
};

} // namespace dunavant_quadratures
